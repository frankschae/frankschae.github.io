<!DOCTYPE html>
<!-- This site was created with Hugo Blox. https://hugoblox.com -->
<!-- Last Published: July 25, 2024 --><html lang="en-us" >


<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  
  
  
    <meta name="generator" content="Hugo Blox Builder 5.9.7" />
  

  
  












  
  










  







  
  
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  

  
  
  
    
      
      <link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap">
      <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap" media="print" onload="this.media='all'">
    
  

  
  

  
  
    
    <script src="/js/mathjax-config.js"></script>
  

  

  <link rel="stylesheet" href="/css/vendor-bundle.min.26c458e6907dc03073573976b7f4044e.css" media="print" onload="this.media='all'">

  
  
  
    
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1.9.4/css/academicons.min.css" integrity="sha512-IW0nhlW5MgNydsXJO40En2EoCkTTjZhI3yuODrZIc8cQ4h1XcF53PsqDHa09NqnkXuIe0Oiyyj171BqZFwISBw==" crossorigin="anonymous" media="print" onload="this.media='all'">
    

    
    
    
    
      
      
    
    
    

    
    
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/leaflet@1.7.1/dist/leaflet.min.css" integrity="" crossorigin="anonymous" media="print" onload="this.media='all'">
    

    

    
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js" integrity="" crossorigin="anonymous" async></script>
      
    
      
      

      
      

      
    
      
      

      
      

      
    
  

  
  
  
  
  
  
  <link rel="stylesheet" href="/css/wowchemy.f6689966c0a10712f95f034011917db0.css" />

  
  
  

  
  
  
  
  
  
  
    
    
    <link rel="stylesheet" href="/css/libs/chroma/github-light.min.css" title="hl-light" media="print" onload="this.media='all'" >
    <link rel="stylesheet" href="/css/libs/chroma/dracula.min.css" title="hl-dark" media="print" onload="this.media='all'" disabled>
  

  
  



























  
  
  






  <meta name="author" content="Frank Schäfer" />





  

<meta name="description" content="First and foremost, I would like to thank my mentors Chris Rackauckas, Moritz Schauer, and Yingbo Ma for their willingness to supervise me in this Google Summer of Code project. Although we are still at the very beginning of the project, we already had plenty of very inspiring discussion." />



<link rel="alternate" hreflang="en-us" href="https://frankschae.github.io/post/gsoc2020-high-weak-order-solvers-sde-adjoints/" />
<link rel="canonical" href="https://frankschae.github.io/post/gsoc2020-high-weak-order-solvers-sde-adjoints/" />



  <link rel="manifest" href="/manifest.webmanifest" />



<link rel="icon" type="image/png" href="/media/icon_hu0b7a4cb9992c9ac0e91bd28ffd38dd00_9727_32x32_fill_lanczos_center_3.png" />
<link rel="apple-touch-icon" type="image/png" href="/media/icon_hu0b7a4cb9992c9ac0e91bd28ffd38dd00_9727_180x180_fill_lanczos_center_3.png" />

<meta name="theme-color" content="#1565c0" />










  
  






<meta property="twitter:card" content="summary" />

  <meta property="twitter:site" content="@GetResearchDev" />
  <meta property="twitter:creator" content="@GetResearchDev" />
<meta property="twitter:image" content="https://frankschae.github.io/media/icon_hu0b7a4cb9992c9ac0e91bd28ffd38dd00_9727_512x512_fill_lanczos_center_3.png" />



  

<meta property="og:type" content="article" />
<meta property="og:site_name" content="FS" />
<meta property="og:url" content="https://frankschae.github.io/post/gsoc2020-high-weak-order-solvers-sde-adjoints/" />
<meta property="og:title" content="GSoC 2020: High weak order SDE solvers and their utility in neural SDEs | FS" />
<meta property="og:description" content="First and foremost, I would like to thank my mentors Chris Rackauckas, Moritz Schauer, and Yingbo Ma for their willingness to supervise me in this Google Summer of Code project. Although we are still at the very beginning of the project, we already had plenty of very inspiring discussion." /><meta property="og:image" content="https://frankschae.github.io/media/icon_hu0b7a4cb9992c9ac0e91bd28ffd38dd00_9727_512x512_fill_lanczos_center_3.png" /><meta property="og:locale" content="en-us" />

  
    <meta
      property="article:published_time"
      content="2020-05-30T15:10:33&#43;02:00"
    />
  
  
    <meta property="article:modified_time" content="2020-05-30T15:10:33&#43;02:00">
  






    






  




<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://frankschae.github.io/post/gsoc2020-high-weak-order-solvers-sde-adjoints/"
  },
  "headline": "GSoC 2020: High weak order SDE solvers and their utility in neural SDEs",
  
  "datePublished": "2020-05-30T15:10:33+02:00",
  "dateModified": "2020-05-30T15:10:33+02:00",
  
  "author": {
    "@type": "Person",
    "name": "Frank Schäfer"
  },
  
  "publisher": {
    "@type": "Organization",
    "name": "FS",
    "logo": {
      "@type": "ImageObject",
      "url": "https://frankschae.github.io/media/icon_hu0b7a4cb9992c9ac0e91bd28ffd38dd00_9727_192x192_fill_lanczos_center_3.png"
    }
  },
  "description": "First and foremost, I would like to thank my mentors Chris Rackauckas, Moritz Schauer, and Yingbo Ma for their willingness to supervise me in this Google Summer of Code project. Although we are still at the very beginning of the project, we already had plenty of very inspiring discussion."
}
</script>

  

  




  
  
  

  
  

  


  
  <title>GSoC 2020: High weak order SDE solvers and their utility in neural SDEs | FS</title>

  
  
  
  











</head>


<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" class="page-wrapper   " data-wc-page-id="b18c7f652abe8e3ab1ef5f8324b079fc" >

  
  
  
  
  
  
  
  
  
  <script src="/js/wowchemy-init.min.9e4214442a7711d35691acd58f6f6361.js"></script>

  


<aside class="search-modal" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#" aria-label="Close"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" spellcheck="false" type="search" class="form-control"
        aria-label="Search...">
        
      </div>

      
      

      

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>



  <div class="page-header header--fixed">
  
  
  
  
  












<header>
  <nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id="navbar-main">
    <div class="container-xl">

      
      <div class="d-none d-lg-inline-flex">
        <a class="navbar-brand" href="/">FS</a>
      </div>
      

      
      <button type="button" class="navbar-toggler" data-toggle="collapse"
              data-target="#navbar-content" aria-controls="navbar-content" aria-expanded="false" aria-label="Toggle navigation">
      <span><i class="fas fa-bars"></i></span>
      </button>
      

      
      <div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none">
        <a class="navbar-brand" href="/">FS</a>
      </div>
      

      
      
      <div class="navbar-collapse main-menu-item collapse justify-content-start" id="navbar-content">

        
        <ul class="navbar-nav d-md-inline-flex">
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
              
              
              
                
              
              
            
          

          <li class="nav-item">
            <a class="nav-link " href="/#about"><span>Home</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
              
              
              
                
              
              
            
          

          <li class="nav-item">
            <a class="nav-link " href="/#posts"><span>Posts</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
              
              
              
                
              
              
            
          

          <li class="nav-item">
            <a class="nav-link " href="/#projects"><span>Research projects</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
              
              
              
                
              
              
            
          

          <li class="nav-item">
            <a class="nav-link " href="/#software"><span>Open source software</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
              
              
              
                
              
              
            
          

          <li class="nav-item">
            <a class="nav-link " href="/#contact"><span>Contact</span></a>
          </li>

          
          

        

          
        </ul>
      </div>

      <ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2">

        
        
          
        

        
        
        
        <li class="nav-item">
          <a class="nav-link js-search" href="#" aria-label="Search"><i class="fas fa-search" aria-hidden="true"></i></a>
        </li>
        

        
        
        
        <li class="nav-item dropdown theme-dropdown">
          <a href="#" class="nav-link" data-toggle="dropdown" aria-haspopup="true" aria-label="Display preferences">
            <i class="fas fa-moon" aria-hidden="true"></i>
          </a>
          <div class="dropdown-menu">
            <a href="#" class="dropdown-item js-set-theme-light">
              <span>Light</span>
            </a>
            <a href="#" class="dropdown-item js-set-theme-dark">
              <span>Dark</span>
            </a>
            <a href="#" class="dropdown-item js-set-theme-auto">
              <span>Automatic</span>
            </a>
          </div>
        </li>
        

        
        

      </ul>

    </div>
  </nav>
</header>


  </div>

  <div class="page-body">
    
    
    

    <article class="article">

  













  

  
  
  
<div class="article-container pt-3">
  <h1>GSoC 2020: High weak order SDE solvers and their utility in neural SDEs</h1>

  
  <p class="page-subtitle">Community bonding period</p>
  

  
    


<div class="article-metadata">

  
  

  
  <span class="article-date">
    
    
      
    
    May 30, 2020
  </span>
  

  

  
  <span class="middot-divider"></span>
  <span class="article-reading-time">
    9 min read
  </span>
  

  
  
  
  

  
  

</div>

    





  
</div>



  <div class="article-container">

    <div class="article-style">
      <p>First and foremost, I would like to thank my mentors <a href="https://github.com/ChrisRackauckas" target="_blank" rel="noopener">Chris Rackauckas</a>, <a href="https://github.com/mschauer" target="_blank" rel="noopener">Moritz Schauer</a>, and  <a href="https://github.com/YingboMa" target="_blank" rel="noopener">Yingbo Ma</a> for their willingness to supervise me in this Google Summer of Code project.
Although we are still at the very beginning of the project, we already had plenty of very inspiring discussion. I will spend the following months implementing both  <strong>new high weak order solvers</strong> as well as <strong>adjoint sensitivity methods</strong> for stochastic differential equations (SDEs).
The project is embedded within the <a href="https://sciml.ai" target="_blank" rel="noopener">SciML</a> organization which, among others, unifies the latest toolsets from scientific machine learning and differential equation solver software.
Ultimately, the planned contributions will allow researchers to simulate (or even <a href="https://diffeqflux.sciml.ai/dev/examples/LV-stochastic/" target="_blank" rel="noopener">control</a>) stochastic dynamics. Also inverse problems, where <a href="https://diffeqflux.sciml.ai/dev/examples/NN-SDE/" target="_blank" rel="noopener">SDE models are fit to data</a>, fall into the scope.
Therefore, relevant applications are found in many fields ranging from the simulation of (bio-)chemical processes over financial modeling to quantum mechanics.</p>
<p>This post is supposed to summarize what we have implemented in this first period and what we are going to do next. Future posts are going to dig into the individual subjects in more details.</p>
<h2 id="high-weak-order-solvers">High Weak Order Solvers</h2>
<p>Currently, the <a href="https://github.com/SciML/StochasticDiffEq.jl" target="_blank" rel="noopener">StochasticDiffEq</a> package contains state-of-the-art solvers for the strong approximation of SDEs, i.e., solvers that allow one to reconstruct correctly the numerical solution of an SDE in a pathwise sense.
In general, an accurate estimation of multiple stochastic integrals is then required to produce a strong method of order greater than 1/2.</p>
<p>However in many situations, we are only aiming for computing an estimation for the <strong>expected value of the solution</strong>.
In such situations, methods for the <strong>weak approximation</strong> are sufficient. The less restrictive formulation of the objective for weak methods has the advantage that they are computationally cheaper than strong methods.
<strong>High weak order solvers</strong> are particularly appealing, as they allow for using much larger time steps while attaining the same error in the mean, as compared with SDE solvers having a smaller weak order convergence.
As an example, when Monte Carlo methods are used for SDE models, it is indeed often sufficient to be able to accurately sample random trajectories of the SDE, and it is not important to accurately approximate a particular trajectory. The former is exactly what a solver with high weak order provides.</p>
<h3 id="second-order-runge-kutta-methods-for-ito-sdes">Second order Runge-Kutta methods for Ito SDEs</h3>
<p>In the beginning of the community bonding period I finished the implementations of the <code>DRI1()</code><sup id="fnref:1"><a href="#fn:1" class="footnote-ref" role="doc-noteref">1</a></sup> and <code>RI1()</code><sup id="fnref:2"><a href="#fn:2" class="footnote-ref" role="doc-noteref">2</a></sup> methods. Both are representing second order Runge-Kutta schemes and were introduced by Rößler. Interestingly, these methods are designed to scale well with the number of Wiener processes <code>m</code>. Specifically, only <code>2m-1</code> random variables have to be drawn (in contrast to <code>m(m+1)/2</code> from previous methods). Additionally, the number of function evaluations for the drift and the diffusion terms is independent of <code>m</code>.</p>
<p>As an example, we can check the second order convergence property on a multi-dimensional SDE with non-commuting noise<sup id="fnref1:1"><a href="#fn:1" class="footnote-ref" role="doc-noteref">1</a></sup>:</p>
<p>$$
\scriptstyle d \begin{pmatrix} X_1 \\  X_2 \end{pmatrix} = \begin{pmatrix} -\frac{273}{512} &amp;  \phantom{X_2}0 \\  -\frac{1}{160} \phantom{X_2}  &amp; -\frac{785}{512}+\frac{\sqrt{2}}{8} \end{pmatrix}  \begin{pmatrix} X_1 \\  X_2 \end{pmatrix} dt + \begin{pmatrix} \frac{1}{4} X_1 &amp;  \frac{1}{16} X_1 \\  \frac{1-2\sqrt{2}}{4} X_2 &amp; \frac{1}{10}X_1  +\frac{1}{16} X_2 \end{pmatrix} d \begin{pmatrix} W_1 \\  W_2 \end{pmatrix} <br>
$$</p>
<p>with initial value $$ X(t=0)=  \begin{pmatrix} 1 \\ 1\end{pmatrix}.$$</p>
<p>For the function $f(x)=(x_1)^2$, we can analytically compute the expected value of the solution</p>
<p>$$ \rm{E}\left[ f(X(t)) \right] =  \exp(-t),$$</p>
<p>which we use to test the weak convergence order of the algorithms in the following.</p>
<p>To compute the expected value numerically, we sample an ensemble of <code>numtraj = 1e7</code> trajectories for different step sizes <code>dt</code>. The code for a single  <code>dt</code> reads:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-julia" data-lang="julia"><span class="line"><span class="cl"><span class="k">using</span> <span class="n">StochasticDiffEq</span>
</span></span><span class="line"><span class="cl"><span class="n">numtraj</span> <span class="o">=</span> <span class="mf">1e7</span>
</span></span><span class="line"><span class="cl"><span class="n">u₀</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="k">function</span> <span class="n">f!</span><span class="p">(</span><span class="n">du</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">t</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="n">du</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">273</span><span class="o">//</span><span class="mi">512</span><span class="o">*</span><span class="n">u</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">  <span class="n">du</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="o">//</span><span class="mi">160</span><span class="o">*</span><span class="n">u</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="p">(</span><span class="o">-</span><span class="mi">785</span><span class="o">//</span><span class="mi">512</span><span class="o">+</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">8</span><span class="p">)</span><span class="o">*</span><span class="n">u</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="k">end</span>
</span></span><span class="line"><span class="cl"><span class="k">function</span> <span class="n">g!</span><span class="p">(</span><span class="n">du</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">t</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="n">du</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="o">//</span><span class="mi">4</span><span class="o">*</span><span class="n">u</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">  <span class="n">du</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="o">//</span><span class="mi">16</span><span class="o">*</span><span class="n">u</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">  <span class="n">du</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">/</span><span class="mi">4</span><span class="o">*</span><span class="n">u</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">  <span class="n">du</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="o">//</span><span class="mi">10</span><span class="o">*</span><span class="n">u</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="o">//</span><span class="mi">16</span><span class="o">*</span><span class="n">u</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="k">end</span>
</span></span><span class="line"><span class="cl"><span class="n">dt</span> <span class="o">=</span> <span class="mi">1</span><span class="o">//</span><span class="mi">8</span>
</span></span><span class="line"><span class="cl"><span class="n">tspan</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">10.0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">prob</span> <span class="o">=</span> <span class="n">SDEProblem</span><span class="p">(</span><span class="n">f!</span><span class="p">,</span><span class="n">g!</span><span class="p">,</span><span class="n">u₀</span><span class="p">,</span><span class="n">tspan</span><span class="p">,</span><span class="n">noise_rate_prototype</span><span class="o">=</span><span class="n">zeros</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">h</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="o">=</span> <span class="n">z</span><span class="o">^</span><span class="mi">2</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">ensemble_prob</span> <span class="o">=</span> <span class="n">EnsembleProblem</span><span class="p">(</span><span class="n">prob</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">output_func</span> <span class="o">=</span> <span class="p">(</span><span class="n">sol</span><span class="p">,</span><span class="n">i</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">(</span><span class="n">h</span><span class="p">(</span><span class="n">sol</span><span class="p">[</span><span class="k">end</span><span class="p">][</span><span class="mi">1</span><span class="p">]),</span><span class="nb">false</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">sol</span> <span class="o">=</span> <span class="n">solve</span><span class="p">(</span><span class="n">ensemble_prob</span><span class="p">,</span> <span class="n">DRI1</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">        <span class="n">dt</span><span class="o">=</span><span class="n">dt</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="n">save_start</span><span class="o">=</span><span class="nb">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="n">save_everystep</span><span class="o">=</span><span class="nb">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="n">weak_timeseries_errors</span><span class="o">=</span><span class="nb">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="n">weak_dense_errors</span><span class="o">=</span><span class="nb">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="n">trajectories</span><span class="o">=</span><span class="n">numtraj</span><span class="p">)</span>
</span></span></code></pre></div><p>We then compute the error of the numerically obtained expected value of the ensemble simulation with respect to the analytical result:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">LinearAlgebra.norm(Statistics.mean(sol.u)-exp(-tspan[2]))
</span></span></code></pre></div><p>Repeating this procedure for some more values of <code>dt</code>, the log-log plot of the error as a function of <code>dt</code> displays nicely the second order convergence (slope $\approx 2.2$).</p>


















<figure  >
  <div class="d-flex justify-content-center">
    <div class="w-100" ><img src="DRI1.png" alt="" loading="lazy" data-zoomable /></div>
  </div></figure>

<p>In the next couple of weeks, my focus will be on</p>
<ul>
<li>adding other high weak order solvers,</li>
<li>implementing adaptive time stepping.</li>
</ul>
<p>More of our near-term goals are collected in this <a href="https://github.com/SciML/StochasticDiffEq.jl/issues/182" target="_blank" rel="noopener">issue</a>.</p>
<h2 id="adjoint-sensitivity-methods-for-sdes">Adjoint Sensitivity Methods for SDEs</h2>
<p>In <a href="https://mitmath.github.io/18337/lecture10/estimation_identification" target="_blank" rel="noopener">parameter estimation/inverse problems</a>, one is interested to know the optimal choice of parameters <code>p</code> such that a model <code>f(p)</code>, e.g., a differential equation, optimally fits some data, y. The shooting method approaches this task by introducing some sort of loss function $L$. A common choice is the mean squared error</p>
<p>$$
L = |f(p)-y|^2.
$$</p>
<p>An optimizer is then used to update the parameters $p$ such that $L$ is minimized. For this fit, local optimizers use the gradient $\frac{dL}{dp}$ to minimize the loss function and ultimately solve the inverse problem.
One possibility to obtain the gradient information for (stochastic) differential equations is to use automatic differentiation (AD).
While forward mode AD is memory efficient, it scales poorly in time with increasing number of parameters. On the contrary, reverse-mode AD, i.e., a direct backpropagation through the solver, has a huge memory footprint.</p>
<p>Alternatively to the &ldquo;direct&rdquo; AD approaches, the <strong>adjoint sensitivity method</strong> can be used<sup id="fnref:3"><a href="#fn:3" class="footnote-ref" role="doc-noteref">3</a></sup>. The adjoint sensitivity method is well known to compute gradients of solutions to ordinary differential equations (ODEs) with respect to the parameters and initial states entering the ODE. The method was recently generalized to SDEs<sup id="fnref:4"><a href="#fn:4" class="footnote-ref" role="doc-noteref">4</a></sup>.
Importantly, this new approach has different complexities in terms of memory consumption or computation time as compared with forward- or reverse-mode AD (NP vs N+P where N is the number of state variables and P is the number of parameters).</p>
<p>It turns out that the aforementioned gradients in the stochastic adjoint sensitivity method are given by solving an SDE with an <strong>augmented state backwards in time</strong> launched at the end state of the forward evolution.  In other words, we first compute the forward time evolution of the model from the start time $t_0$ to the end time $t_1$. Subsequently, we reverse the SDE and run a second time evolution from $t_1$ to $t_0$. Please note that the authors in Ref. <sup id="fnref1:4"><a href="#fn:4" class="footnote-ref" role="doc-noteref">4</a></sup> are implementing a slightly modfified version where the time evolution of the augmented state runs from $-t_1$ to $-t_0$. We however are indeed using the former variant as it allows us to reuse/generalize many functions that were implemented in the <a href="https://github.com/SciML/DiffEqSensitivity.jl/" target="_blank" rel="noopener">DiffEqSensitivity</a> package for ODE adjoints earlier.</p>
<h3 id="reverse-sde-time-evolution">Reverse SDE time evolution</h3>
<p>The reversion of an SDE is more difficult than the reversion of an ODE. However, for SDEs written in the Stratonovich sense, it turns out that reversion can be achieved by negative signs in front of the drift and diffusion terms.
As one needs to follow the same trajectory backward, the noise sampled in the forward pass must be reconstructed.
In general, we would like to use adaptive time-stepping solvers which require some form of interpolation for the noise values.
After some fixes for the <a href="https://docs.sciml.ai/latest/features/noise_process/#Adaptive-NoiseWrapper-Example-1" target="_blank" rel="noopener">available noise processes</a>, we are now able to reverse a stochastic time evolution either by using <code>NoiseGrid</code> which linearly interpolates between values of the noise on a given grid or by using a very general <code>NoiseWrapper</code> which interpolates in a distributionally-exact manner based on Brownian bridges.</p>
<p>As an example, the code below computes first the forward evolution of an SDE</p>
<p>$$ dX  =  \alpha X dt + \beta X dW$$</p>
<p>with $\alpha=1.01$, $\beta=0.87$, $x(0)=1/2$, in the time span ($t_{0}=0$, $t_{1}=1)$. This forward evolution is shown in blue in the animation below. Subsequently, also the reverse time evolution (red) launched at time $t_{1}=1$ with initial value $x(t=1)$, propagated in negative time direction until $t_{0}=0$, is computed. We see that both trajectories match very well.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-julia" data-lang="julia"><span class="line"><span class="cl">  <span class="k">using</span> <span class="n">StochasticDiffEq</span><span class="p">,</span> <span class="n">DiffEqNoiseProcess</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">α</span><span class="o">=</span><span class="mf">1.01</span>
</span></span><span class="line"><span class="cl">  <span class="n">β</span><span class="o">=</span><span class="mf">0.87</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">dt</span> <span class="o">=</span> <span class="mf">1e-3</span>
</span></span><span class="line"><span class="cl">  <span class="n">tspan</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="n">u₀</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">tarray</span> <span class="o">=</span>  <span class="n">collect</span><span class="p">(</span><span class="n">tspan</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">:</span><span class="n">dt</span><span class="o">:</span><span class="n">tspan</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">f!</span><span class="p">(</span><span class="n">du</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">t</span><span class="p">)</span> <span class="o">=</span> <span class="n">du</span> <span class="o">.=</span> <span class="n">α</span><span class="o">*</span><span class="n">u</span>
</span></span><span class="line"><span class="cl">  <span class="n">g!</span><span class="p">(</span><span class="n">du</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">t</span><span class="p">)</span> <span class="o">=</span> <span class="n">du</span> <span class="o">.=</span> <span class="n">β</span><span class="o">*</span><span class="n">u</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">prob</span> <span class="o">=</span> <span class="n">SDEProblem</span><span class="p">(</span><span class="n">f!</span><span class="p">,</span><span class="n">g!</span><span class="p">,[</span><span class="n">u₀</span><span class="p">],</span><span class="n">tspan</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="n">sol</span> <span class="o">=</span><span class="n">solve</span><span class="p">(</span><span class="n">prob</span><span class="p">,</span><span class="n">EulerHeun</span><span class="p">(),</span><span class="n">dt</span><span class="o">=</span><span class="n">dt</span><span class="p">,</span><span class="n">save_noise</span><span class="o">=</span><span class="nb">true</span><span class="p">,</span> <span class="n">adaptive</span><span class="o">=</span><span class="nb">false</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">_sol</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">sol</span><span class="p">)</span> <span class="c"># to make sure the plot is correct</span>
</span></span><span class="line"><span class="cl">  <span class="n">W1</span> <span class="o">=</span> <span class="n">NoiseGrid</span><span class="p">(</span><span class="n">reverse!</span><span class="p">(</span><span class="n">_sol</span><span class="o">.</span><span class="n">t</span><span class="p">),</span><span class="n">reverse!</span><span class="p">(</span><span class="n">_sol</span><span class="o">.</span><span class="n">W</span><span class="o">.</span><span class="n">W</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">  <span class="n">prob1</span> <span class="o">=</span> <span class="n">SDEProblem</span><span class="p">(</span><span class="n">f!</span><span class="p">,</span><span class="n">g!</span><span class="p">,</span><span class="n">sol</span><span class="p">[</span><span class="k">end</span><span class="p">],</span><span class="n">reverse</span><span class="p">(</span><span class="n">tspan</span><span class="p">),</span><span class="n">noise</span><span class="o">=</span><span class="n">W1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="n">sol1</span> <span class="o">=</span> <span class="n">solve</span><span class="p">(</span><span class="n">prob1</span><span class="p">,</span><span class="n">EulerHeun</span><span class="p">(),</span><span class="n">dt</span><span class="o">=</span><span class="n">dt</span><span class="p">)</span>
</span></span></code></pre></div>

















<figure  >
  <div class="d-flex justify-content-center">
    <div class="w-100" ><img src="animation.gif" alt="" loading="lazy" data-zoomable /></div>
  </div></figure>

<h3 id="gradients-of-diagonal-sdes">Gradients of diagonal SDEs</h3>
<p>I have already started to implement the stochastic adjoint sensitivity method for SDEs possessing diagonal noise. Currently, only out-of-place SDE functions are supported but I am optimistic that soon also the inplace formulation works.</p>
<p>Let us consider again the linear SDE with multiplicative noise from above (with the same parameters). This SDE represents one of the few exact solvable cases. In the Stratonovich sense, the solution is given as</p>
<p>$$ X(t) =  X(0) \exp(\alpha t + \beta W(t)).$$</p>
<p>We might be interested in optimizing the parameters $\alpha$ and $\beta$ to minimize a certain loss function acting on the solution $X(t)$. For such an optimization task, a useful search direction is indicated by the gradient of the loss function with respect to the parameters. The latter however requires the differentiation through the SDE solver &ndash; if no analytical solution of the SDE is available.</p>
<p>As an example, let us consider a mean squared error loss</p>
<p>$$
L(X(t)) = \sum_i |X(t_i)|^2,
$$</p>
<p>acting on the solution $X(t)$ for some fixed time points $t_i$. Then, the analytical forms for the gradients here read</p>
<p>$$
\begin{aligned}
\frac{d L}{d \alpha} &amp;= 2 \sum_i t_i |X(t_i)|^2 \\
\frac{d L}{d \beta}  &amp;= 2 \sum_i W(t_i) |X(t_i)|^2
\end{aligned}
$$</p>
<p>for $\alpha$ and $\beta$, respectively. We can confirm that this agrees with the gradients as obtained by the stochastic adjoint sensitivity method</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-julia" data-lang="julia"><span class="line"><span class="cl"><span class="k">using</span> <span class="n">Test</span><span class="p">,</span> <span class="n">LinearAlgebra</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="n">DiffEqSensitivity</span><span class="p">,</span> <span class="n">StochasticDiffEq</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="n">Random</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">seed</span> <span class="o">=</span> <span class="mi">100</span>
</span></span><span class="line"><span class="cl"><span class="n">Random</span><span class="o">.</span><span class="n">seed!</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">u₀</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">tstart</span> <span class="o">=</span> <span class="mf">0.0</span>
</span></span><span class="line"><span class="cl"><span class="n">tend</span> <span class="o">=</span> <span class="mf">0.1</span>
</span></span><span class="line"><span class="cl"><span class="n">dt</span> <span class="o">=</span> <span class="mf">0.005</span>
</span></span><span class="line"><span class="cl"><span class="n">trange</span> <span class="o">=</span> <span class="p">(</span><span class="n">tstart</span><span class="p">,</span> <span class="n">tend</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">t</span> <span class="o">=</span> <span class="n">tstart</span><span class="o">:</span><span class="n">dt</span><span class="ss">:tend</span>
</span></span><span class="line"><span class="cl"><span class="n">tarray</span> <span class="o">=</span> <span class="n">collect</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">function</span> <span class="n">g</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">t</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="n">sum</span><span class="p">(</span><span class="n">u</span><span class="o">.^</span><span class="mf">2.0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">end</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">function</span> <span class="n">dg!</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">(</span><span class="n">out</span><span class="o">.=-</span><span class="mf">2.0</span><span class="o">*</span><span class="n">u</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">end</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">p2</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.01</span><span class="p">,</span><span class="mf">0.87</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">f</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">t</span><span class="p">)</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">u</span>
</span></span><span class="line"><span class="cl"><span class="n">σ</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">t</span><span class="p">)</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">u</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">Random</span><span class="o">.</span><span class="n">seed!</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">prob</span> <span class="o">=</span> <span class="n">SDEProblem</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">σ</span><span class="p">,</span><span class="n">u₀</span><span class="p">,</span><span class="n">trange</span><span class="p">,</span><span class="n">p2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">sol</span> <span class="o">=</span> <span class="n">solve</span><span class="p">(</span><span class="n">prob</span><span class="p">,</span><span class="n">RKMil</span><span class="p">(</span><span class="n">interpretation</span><span class="o">=</span><span class="ss">:Stratonovich</span><span class="p">),</span><span class="n">dt</span><span class="o">=</span><span class="n">tend</span><span class="o">/</span><span class="mf">1e7</span><span class="p">,</span><span class="n">adaptive</span><span class="o">=</span><span class="nb">false</span><span class="p">,</span><span class="n">save_noise</span><span class="o">=</span><span class="nb">true</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">res_u0</span><span class="p">,</span> <span class="n">res_p</span> <span class="o">=</span> <span class="n">adjoint_sensitivities</span><span class="p">(</span><span class="n">sol</span><span class="p">,</span><span class="n">EulerHeun</span><span class="p">(),</span><span class="n">dg!</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">dt</span><span class="o">=</span><span class="n">tend</span><span class="o">/</span><span class="mf">1e7</span><span class="p">,</span><span class="n">sensealg</span><span class="o">=</span><span class="n">BacksolveAdjoint</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">noise</span> <span class="o">=</span> <span class="n">vec</span><span class="p">((</span><span class="nd">@.</span> <span class="n">sol</span><span class="o">.</span><span class="n">W</span><span class="p">(</span><span class="n">tarray</span><span class="p">)))</span>
</span></span><span class="line"><span class="cl"><span class="n">Wextracted</span> <span class="o">=</span> <span class="p">[</span><span class="n">W</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">W</span> <span class="k">in</span> <span class="n">noise</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">resp1</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">sum</span><span class="p">(</span><span class="nd">@.</span> <span class="n">tarray</span><span class="o">*</span><span class="n">u₀</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">p2</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="n">tarray</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">p2</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">Wextracted</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">resp2</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">sum</span><span class="p">(</span><span class="nd">@.</span> <span class="n">Wextracted</span><span class="o">*</span><span class="n">u₀</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">p2</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="n">tarray</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">p2</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">Wextracted</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">resp</span> <span class="o">=</span> <span class="p">[</span><span class="n">resp1</span><span class="p">,</span> <span class="n">resp2</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@test</span> <span class="n">isapprox</span><span class="p">(</span><span class="n">res_p</span><span class="o">&#39;</span><span class="p">,</span> <span class="n">resp</span><span class="p">,</span> <span class="n">rtol</span> <span class="o">=</span> <span class="mf">1e-6</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c"># True</span>
</span></span></code></pre></div><p>With respect to the adjoint sensitivity methods, we are planning to</p>
<ul>
<li>finish the current backsolve adjoint version,</li>
<li>allow for computing the gradients of non-commuting SDEs,</li>
<li>implement also an interpolation adjoint version,</li>
<li>benchmark it with respect to AD approaches</li>
</ul>
<p>in the upcoming weeks. For more information, the interested reader might take a look at the open <a href="https://github.com/SciML/DiffEqSensitivity.jl/issues" target="_blank" rel="noopener">issues</a> in the DiffEqSensitivity package.</p>
<p>If you have any questions or comments, please don’t hesitate to contact me!</p>
<div class="footnotes" role="doc-endnotes">
<hr>
<ol>
<li id="fn:1">
<p>Kristian Debrabant, Andreas Rößler, Applied Numerical Mathematics <strong>59</strong>, 582–594 (2009).&#160;<a href="#fnref:1" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a>&#160;<a href="#fnref1:1" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:2">
<p>Andreas Rößler, Journal on Numerical Analysis <strong>47</strong>, 1713–1738 (2009).&#160;<a href="#fnref:2" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:3">
<p>Steven G. Johnson, &ldquo;Notes on Adjoint Methods for 18.335.&rdquo; Introduction to Numerical Methods (2012).&#160;<a href="#fnref:3" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:4">
<p>Xuechen Li, Ting-Kam Leonard Wong, Ricky T. Q. Chen, David Duvenaud, arXiv preprint arXiv:2001.01328 (2020).&#160;<a href="#fnref:4" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a>&#160;<a href="#fnref1:4" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
</ol>
</div>

    </div>

    





<div class="article-tags">
  
  <a class="badge badge-light" href="/tag/gsoc-2020/">GSoC 2020</a>
  
  <a class="badge badge-light" href="/tag/julia/">Julia</a>
  
  <a class="badge badge-light" href="/tag/high-weak-order-solver/">High Weak Order Solver</a>
  
  <a class="badge badge-light" href="/tag/srk-methods/">SRK Methods</a>
  
  <a class="badge badge-light" href="/tag/adjoint-sensitivity-methods/">Adjoint Sensitivity Methods</a>
  
</div>



<div class="share-box">
  <ul class="share">
    
      
      
      
        
      
      
      
      
      
      
      
      <li>
        <a href="https://twitter.com/intent/tweet?url=https%3A%2F%2Ffrankschae.github.io%2Fpost%2Fgsoc2020-high-weak-order-solvers-sde-adjoints%2F&amp;text=GSoC&#43;2020%3A&#43;High&#43;weak&#43;order&#43;SDE&#43;solvers&#43;and&#43;their&#43;utility&#43;in&#43;neural&#43;SDEs" target="_blank" rel="noopener" class="share-btn-twitter" aria-label="twitter">
          <i class="fab fa-twitter"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      
      
      
      
      <li>
        <a href="https://www.facebook.com/sharer.php?u=https%3A%2F%2Ffrankschae.github.io%2Fpost%2Fgsoc2020-high-weak-order-solvers-sde-adjoints%2F&amp;t=GSoC&#43;2020%3A&#43;High&#43;weak&#43;order&#43;SDE&#43;solvers&#43;and&#43;their&#43;utility&#43;in&#43;neural&#43;SDEs" target="_blank" rel="noopener" class="share-btn-facebook" aria-label="facebook">
          <i class="fab fa-facebook"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      
      
      
      
        
      
      <li>
        <a href="mailto:?subject=GSoC%202020%3A%20High%20weak%20order%20SDE%20solvers%20and%20their%20utility%20in%20neural%20SDEs&amp;body=https%3A%2F%2Ffrankschae.github.io%2Fpost%2Fgsoc2020-high-weak-order-solvers-sde-adjoints%2F" target="_blank" rel="noopener" class="share-btn-email" aria-label="envelope">
          <i class="fas fa-envelope"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      
      
      
      
      <li>
        <a href="https://www.linkedin.com/shareArticle?url=https%3A%2F%2Ffrankschae.github.io%2Fpost%2Fgsoc2020-high-weak-order-solvers-sde-adjoints%2F&amp;title=GSoC&#43;2020%3A&#43;High&#43;weak&#43;order&#43;SDE&#43;solvers&#43;and&#43;their&#43;utility&#43;in&#43;neural&#43;SDEs" target="_blank" rel="noopener" class="share-btn-linkedin" aria-label="linkedin-in">
          <i class="fab fa-linkedin-in"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      
      
      
      
      <li>
        <a href="whatsapp://send?text=GSoC&#43;2020%3A&#43;High&#43;weak&#43;order&#43;SDE&#43;solvers&#43;and&#43;their&#43;utility&#43;in&#43;neural&#43;SDEs%20https%3A%2F%2Ffrankschae.github.io%2Fpost%2Fgsoc2020-high-weak-order-solvers-sde-adjoints%2F" target="_blank" rel="noopener" class="share-btn-whatsapp" aria-label="whatsapp">
          <i class="fab fa-whatsapp"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      
      
      
      
      <li>
        <a href="https://service.weibo.com/share/share.php?url=https%3A%2F%2Ffrankschae.github.io%2Fpost%2Fgsoc2020-high-weak-order-solvers-sde-adjoints%2F&amp;title=GSoC&#43;2020%3A&#43;High&#43;weak&#43;order&#43;SDE&#43;solvers&#43;and&#43;their&#43;utility&#43;in&#43;neural&#43;SDEs" target="_blank" rel="noopener" class="share-btn-weibo" aria-label="weibo">
          <i class="fab fa-weibo"></i>
        </a>
      </li>
    
  </ul>
</div>











  
  



  
  
  
    
  
  
  
  <div class="media author-card content-widget-hr">
    
      
      <a href="https://frankschae.github.io/"><img class="avatar mr-3 avatar-circle" src="/authors/admin/avatar_hu5bdd272e648badb42a595cb37d3ba435_2457515_270x270_fill_lanczos_center_3.png" alt="Frank Schäfer"></a>
    

    <div class="media-body">
      <h5 class="card-title"><a href="https://frankschae.github.io/">Frank Schäfer</a></h5>
      <h6 class="card-subtitle">Postdoctoral researcher</h6>
      <p class="card-text">My research interests include many-body physics, probabilistic machine learning, and differentiable programming.</p>
      <ul class="network-icon" aria-hidden="true">
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="/#contact" >
        <i class="fas fa-envelope"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://twitter.com/_Frank_Schaefer" target="_blank" rel="noopener">
        <i class="fab fa-twitter"></i>
      </a>
    </li>
  
    
    
    
    
    
    
    
      
    
    <li>
      <a href="https://scholar.google.com/citations?user=goAokcEAAAAJ&amp;hl=de&amp;oi=sra#" target="_blank" rel="noopener">
        <i class="ai ai-google-scholar"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://github.com/frankschae" target="_blank" rel="noopener">
        <i class="fab fa-github"></i>
      </a>
    </li>
  
    
    
    
    
    
    
    
      
    
    <li>
      <a href="https://orcid.org/0000-0003-2684-4984" target="_blank" rel="noopener">
        <i class="ai ai-orcid"></i>
      </a>
    </li>
  
</ul>

    </div>
  </div>


















  </div>
</article>
  </div>

  <div class="page-footer">
    
    
    <div class="container">
      <footer class="site-footer">

  












  
  
  
  
  













  
  
  

  
  
    
  
  
    
  

  

  
  <p class="powered-by copyright-license-text">
    © 2024 Frank Schäfer. This work is licensed under <a href="https://creativecommons.org/licenses/by-nc-nd/4.0" rel="noopener noreferrer" target="_blank">CC BY NC ND 4.0</a>
  </p>
  

  <p class="powered-by footer-license-icons">
    <a href="https://creativecommons.org/licenses/by-nc-nd/4.0" rel="noopener noreferrer" target="_blank" aria-label="Creative Commons">
      <i class="fab fa-creative-commons fa-2x" aria-hidden="true"></i>
      <i class="fab fa-creative-commons-by fa-2x" aria-hidden="true"></i>
      
        <i class="fab fa-creative-commons-nc fa-2x" aria-hidden="true"></i>
      
      
        <i class="fab fa-creative-commons-nd fa-2x" aria-hidden="true"></i>
      
    </a>
  </p>





  <p class="powered-by">
    
    
    
      
      
      
      
      
      
      Published with <a href="https://hugoblox.com/?utm_campaign=poweredby" target="_blank" rel="noopener">Hugo Blox Builder</a> — the free, <a href="https://github.com/HugoBlox/hugo-blox-builder" target="_blank" rel="noopener">open source</a> website builder that empowers creators.
    
  </p>
</footer>

    </div>
    
  </div>

  


<script src="/js/vendor-bundle.min.ff7771056d34ad9f2de2d8f6a466e748.js"></script>




  

  
  

  






  <script src="https://cdn.jsdelivr.net/npm/leaflet@1.7.1/dist/leaflet.min.js" integrity="" crossorigin="anonymous"></script>








  
  <script id="search-hit-fuse-template" type="text/x-template">
    <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
    </div>
  </script>
  
    <script src="https://cdn.jsdelivr.net/gh/krisk/Fuse@v3.2.1/dist/fuse.min.js" integrity="sha512-o38bmzBGX+hD3JHWUFCDA09btWaqrNmoJ3RXLlrysA7PP01Kgs4UlE4MhelE1v5dJR3+cxlR4qQlotsW7jKsnw==" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/gh/julmot/mark.js@8.11.1/dist/jquery.mark.min.js" integrity="sha512-mhbv5DqBMgrWL+32MmsDOt/OAvqr/cHimk6B8y/bx/xS88MVkYGPiVv2ixKVrkywF2qHplNRUvFsAHUdxZ3Krg==" crossorigin="anonymous"></script>
  












  
  
  
  
  
  
  

















<script id="page-data" type="application/json">{"use_headroom":true}</script>


  <script src="/js/wowchemy-headroom.db4755770454eb63685f8de785c0a172.js" type="module"></script>









  
  


<script src="/en/js/wowchemy.min.7f5ebaff62ae468cff8bb3dd1337bb9b.js"></script>



  <script src="/js/wowchemy-map.a26e9d2f7238ba5b868384f1c5bc6477.js" type="module"></script>




  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        
        <pre><code></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>


  <script src="/js/wowchemy-publication.9c0e895144aef5a693008b5c5d450147.js" type="module"></script>


















</body>
</html>
